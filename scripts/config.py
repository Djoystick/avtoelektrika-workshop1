#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
üîß –ú–ê–°–¢–ï–†–°–ö–ê–Ø –ê–í–¢–û–≠–õ–ï–ö–¢–†–ò–ö–ê v3.3
–ë–ê–ó–ê –ó–ù–ê–ù–ò–ô: Drive2, YouTube + –§–æ—Ä—É–º—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ (–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ)
"""

import os

MAX_NEWS_PER_SOURCE = 40  # –û–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è GitHub Actions
MAX_TOTAL_NEWS = 2500

# ==================================================
# –ò–°–¢–û–ß–ù–ò–ö–ò (–¢–æ–ª—å–∫–æ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –∏ –¥–æ—Å—Ç—É–ø–Ω—ã–µ)
# ==================================================

NEWS_SOURCES = [
    # ===== –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ò OBD –ö–û–î–´ (–ó–∞–º–µ–Ω–∞ –ø–ª–∞—Ç–Ω—ã–º API) =====
    {"name": "Ross-Tech (VCDS) - –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞", "url": "https://forums.ross-tech.com/index.php?forums/general-vw-audi-repair.14/index.rss", "category": "üíª –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ VAG", "type": "forum"},
    {"name": "Carerac - –ö–æ–¥—ã –æ—à–∏–±–æ–∫", "url": "https://carerac.com/rss.xml", "category": "üíª –ö–æ–¥—ã OBD2", "type": "guide"},
    
    # ===== DRIVE2 (–õ—É—á—à–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫ —Ä—É–Ω–µ—Ç–∞) =====
    {"name": "Drive2 - –ü–æ–ª–æ–º–∫–∏", "url": "https://www.drive2.ru/r/rss/breakdown/", "category": "üÜò –†–µ—à–µ–Ω–∏—è", "type": "forum"},
    {"name": "Drive2 - –≠–ª–µ–∫—Ç—Ä–∏–∫–∞", "url": "https://www.drive2.ru/r/rss/electrics/", "category": "‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞", "type": "forum"},
    {"name": "Drive2 - –°–≤–æ–∏–º–∏ —Ä—É–∫–∞–º–∏", "url": "https://www.drive2.ru/r/rss/diy/", "category": "üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏", "type": "guide"},
    {"name": "Drive2 - –≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞", "url": "https://www.drive2.ru/r/rss/electronics/", "category": "üíª –≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞", "type": "forum"},
    {"name": "Drive2 - –ê–≤—Ç–æ–∑–≤—É–∫", "url": "https://www.drive2.ru/r/rss/caraudio/", "category": "üîä –ê–≤—Ç–æ–∑–≤—É–∫", "type": "guide"},

    # ===== YOUTUBE –ü–û–ò–°–ö–û–í–´–ï –õ–ï–ù–¢–´ (–°–∞–º—ã–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ) =====
    {"name": "YT - –ù–µ –∑–∞–≤–æ–¥–∏—Ç—Å—è", "url": "https://www.youtube.com/feeds/videos.xml?search_query=–º–∞—à–∏–Ω–∞+–Ω–µ+–∑–∞–≤–æ–¥–∏—Ç—Å—è+–ø—Ä–∏—á–∏–Ω–∞", "category": "üÜò –ù–µ –∑–∞–≤–æ–¥–∏—Ç—Å—è", "type": "video"},
    {"name": "YT - –û—à–∏–±–∫–∏ OBD2", "url": "https://www.youtube.com/feeds/videos.xml?search_query=–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞+–æ—à–∏–±–æ–∫+elm327", "category": "üíª –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞", "type": "video"},
    {"name": "YT - –†–µ–º–æ–Ω—Ç –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞", "url": "https://www.youtube.com/feeds/videos.xml?search_query=—Ä–µ–º–æ–Ω—Ç+–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞+—Å–≤–æ–∏–º–∏+—Ä—É–∫–∞–º–∏", "category": "‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞", "type": "video"},
    {"name": "YT - –†–µ–º–æ–Ω—Ç —Å—Ç–∞—Ä—Ç–µ—Ä–∞", "url": "https://www.youtube.com/feeds/videos.xml?search_query=—Ä–µ–º–æ–Ω—Ç+—Å—Ç–∞—Ä—Ç–µ—Ä–∞+–Ω–µ+–∫—Ä—É—Ç–∏—Ç", "category": "‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞", "type": "video"},
    {"name": "YT - –ü–æ–∏—Å–∫ —É—Ç–µ—á–∫–∏ —Ç–æ–∫–∞", "url": "https://www.youtube.com/feeds/videos.xml?search_query=–∫–∞–∫+–Ω–∞–π—Ç–∏+—É—Ç–µ—á–∫—É+—Ç–æ–∫–∞+–≤+–∞–≤—Ç–æ–º–æ–±–∏–ª–µ", "category": "‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞", "type": "video"},

    # ===== YOUTUBE –ö–ê–ù–ê–õ–´ –ú–ê–°–¢–ï–†–û–í (–ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ) =====
    {"name": "–ò–ª—å–¥–∞—Ä –ê–≤—Ç–æ-–ø–æ–¥–±–æ—Ä", "url": "https://www.youtube.com/feeds/videos.xml?channel_id=UCwP0lGe7yC-v3V_q-Oq-jHw", "category": "üé¨ –ú–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å", "type": "video"},
    {"name": "–ì–∞—Ä–∞–∂ 54", "url": "https://www.youtube.com/feeds/videos.xml?channel_id=UCb0P2k5f77n6yGzJ6r6R78A", "category": "üé¨ –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã", "type": "video"},
    {"name": "–í –≥–∞—Ä–∞–∂–µ —É –°–∞–Ω–¥—Ä–æ", "url": "https://www.youtube.com/feeds/videos.xml?channel_id=UCqJqV8e8t7wz_xK9y6Vq_5g", "category": "üîß –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞", "type": "video"},
    {"name": "–°–¢–û –ö–æ–≤—à", "url": "https://www.youtube.com/feeds/videos.xml?channel_id=UCtLqS4W0dIpxKsBSQ961YXg", "category": "üîß –î–∏–∑–µ–ª—å", "type": "video"},
    {"name": "KPOWERtuning", "url": "https://www.youtube.com/feeds/videos.xml?channel_id=UCdbd3b7o3x0VfU1B9D8R5gA", "category": "‚öôÔ∏è –ö–∞–ø—Ä–µ–º–æ–Ω—Ç", "type": "video"},
    {"name": "Denis M", "url": "https://www.youtube.com/feeds/videos.xml?channel_id=UChd8yXhYQd2jssYy_a4d_yA", "category": "üíª –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞", "type": "video"},
    {"name": "–ù–∞–∫–∞—á–∞–Ω–Ω—ã–µ –∫–æ–ª—ë—Å–∞", "url": "https://www.youtube.com/feeds/videos.xml?channel_id=UCj_8c3w_GgQh_6k5f8f8x8w", "category": "üé¨ –í–∏–¥–µ–æ", "type": "video"},

    # ===== –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –ë–ê–ó–´ =====
    {"name": "–õ–∞–¥–∞.–û–Ω–ª–∞–π–Ω - –†–µ–º–æ–Ω—Ç", "url": "https://xn--80aal0a.xn--80asehdb/rss.xml", "category": "üöó Lada", "type": "guide"},
    {"name": "ABW.by - –¢–µ—Ö–Ω–∏–∫–∞", "url": "https://www.abw.by/rss/all.rss", "category": "üìö –°–ø—Ä–∞–≤–∫–∞", "type": "guide"},
    {"name": "Habr - DIY", "url": "https://habr.com/ru/rss/hubs/diy/articles/", "category": "üíª DIY", "type": "guide"},
]

# ==================================================
# –§–ò–õ–¨–¢–†–´ (–û—Ç—Å–µ–∫–∞–µ–º –ª–∏—à–Ω–µ–µ)
# ==================================================

EXCLUDE_KEYWORDS = [
    "–ø–æ–ª–∏—Ç–∏–∫–∞", "–≤—ã–±–æ—Ä—ã", "–¥–µ–ø—É—Ç–∞—Ç", "—Å–∞–Ω–∫—Ü–∏–∏", "–≤–æ–π–Ω–∞", "—É–∫—Ä–∞–∏–Ω–∞", "—Å–≤–æ",
    "–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ", "–æ—Ç–ø—É—Å–∫", "—Ç—É—Ä–∏–∑–º", "–æ—Ç–µ–ª—å", "–ø—Ä–∏—Ä–æ–¥–∞", "–ø–æ–≥–æ–¥–∞",
    "—Å–ø–æ—Ä—Ç", "—Ñ—É—Ç–±–æ–ª", "—Ö–æ–∫–∫–µ–π", "–º–∞—Ç—á", "–æ–ª–∏–º–ø–∏–∞–¥–∞",
    "–∫–∏–Ω–æ", "—Ñ–∏–ª—å–º", "—Å–µ—Ä–∏–∞–ª", "–∞–∫—Ç–µ—Ä", "—à–æ—É", "–∫–æ–Ω—Ü–µ—Ä—Ç",
    "–∫—Ä–µ–¥–∏—Ç", "—Ü–µ–Ω–∞", "–ø—Ä–æ–¥–∞–∂–∏", "—Å–∫–∏–¥–∫–∏", "–∞–∫—Ü–∏—è", "—Ä–æ–∑—ã–≥—Ä—ã—à",
    "–Ω–æ–≤–æ—Å—Ç–∏", "–∞–Ω–æ–Ω—Å", "–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è", "–∫–æ–Ω—Ü–µ–ø—Ç-–∫–∞—Ä",
]

INSTRUCTION_KEYWORDS = [
    "—Ä–µ–º–æ–Ω—Ç", "–∑–∞–º–µ–Ω–∞", "—Å–Ω—è—Ç–∏–µ", "—É—Å—Ç–∞–Ω–æ–≤–∫–∞", "—Ä–∞–∑–±–æ—Ä–∫–∞", "—Å–±–æ—Ä–∫–∞",
    "–∫–∞–∫", "—Å–ø–æ—Å–æ–±", "–º–µ—Ç–æ–¥", "–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è", "–≥–∞–π–¥", "tutorial", "manual",
    "–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞", "–ø—Ä–æ–≤–µ—Ä–∫–∞", "–ø–æ–∏—Å–∫", "–ø—Ä–∏—á–∏–Ω–∞", "—Ä–µ—à–µ–Ω–∏–µ", "—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ",
    "—Å–≤–æ–∏–º–∏ —Ä—É–∫–∞–º–∏", "—Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ", "–æ–ø—ã—Ç", "–æ—Ç—á–µ—Ç", "—Ñ–æ—Ç–æ–æ—Ç—á–µ—Ç",
    "–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç", "–Ω–µ –∑–∞–≤–æ–¥–∏—Ç—Å—è", "–æ—Ç–∫–∞–∑–∞–ª", "—Å–ª–æ–º–∞–ª—Å—è", "–≥–ª—é—á–∏—Ç",
    "–æ—à–∏–±–∫–∞", "–∫–æ–¥", "check engine", "—Ç—Ä–æ–∏—Ç", "–≥–ª–æ—Ö–Ω–µ—Ç", "—Å—Ç—É—á–∏—Ç",
    "—Ä–µ—à–∏–ª", "–∏—Å–ø—Ä–∞–≤–∏–ª", "–ø–æ—á–∏–Ω–∏–ª", "–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª", "—Å–¥–µ–ª–∞–ª",
]

ERROR_CODES = [
    'P0300', 'P0301', 'P0302', 'P0303', 'P0304', 'P0171', 'P0172',
    'P0420', 'P0430', 'P0130', 'P0135', 'P0141', 'P0100', 'P0101',
    'P0102', 'P0110', 'P0115', 'P0120', 'P0128', 'P0200', 'P0230',
    'P0400', 'P0401', 'P0440', 'P0441', 'P0500', 'P0505', 'P0700',
    'U0100', 'U0101', 'U0121', 'C0035', 'C0040', 'B0001', 'P0011',
    'P0012', 'P0014', 'P0016', 'P0017', 'P0030', 'P0031', 'P0032'
]

PROBLEM_CATEGORIES = {
    "üÜò –ù–µ –∑–∞–≤–æ–¥–∏—Ç—Å—è": ["–Ω–µ –∑–∞–≤–æ–¥–∏—Ç—Å—è", "–Ω–µ –∫—Ä—É—Ç–∏—Ç", "—â–µ–ª–∫–∞–µ—Ç", "–º–æ–ª—á–∏—Ç", "–Ω–µ—Ç –∑–∞–ø—É—Å–∫–∞"],
    "‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫–∞": ["–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä", "–∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä", "—Å—Ç–∞—Ä—Ç–µ—Ä", "–ø—Ä–æ–≤–æ–¥–∫–∞", "–ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å", "—Ä–µ–ª–µ", "—Ç–æ–∫", "–Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ"],
    "üîß –î–≤–∏–≥–∞—Ç–µ–ª—å": ["–¥–≤–∏–≥–∞—Ç–µ–ª—å", "–º–∞—Å–ª–æ", "–∫–ª–∞–ø–∞–Ω", "–ø–æ—Ä—à–µ–Ω—å", "–≥—Ä–º", "—Ü–µ–ø—å", "–∫–æ–º–ø—Ä–µ—Å—Å–∏—è"],
    "üöó –ü–æ–¥–≤–µ—Å–∫–∞": ["–ø–æ–¥–≤–µ—Å–∫–∞", "—Ä—ã—á–∞–≥", "–∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä", "—à–∞—Ä–æ–≤–∞—è", "—Å–∞–π–ª–µ–Ω—Ç–±–ª–æ–∫", "—Å—Ç—É–∫"],
    "üíª –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞": ["—Å–∫–∞–Ω–µ—Ä", "obd", "elm327", "–æ—à–∏–±–∫–∞", "–∫–æ–¥", "check engine", "–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞"],
    "üõ¢Ô∏è –¢–æ–ø–ª–∏–≤–æ": ["–±–µ–Ω–∑–æ–Ω–∞—Å–æ—Å", "–Ω–∞—Å–æ—Å", "—Ñ–∏–ª—å—Ç—Ä", "—Ñ–æ—Ä—Å—É–Ω–∫–∞", "–∏–Ω–∂–µ–∫—Ç–æ—Ä", "–¥–∞–≤–ª–µ–Ω–∏–µ"],
    "üå°Ô∏è –ö–ª–∏–º–∞—Ç": ["–ø–µ—á–∫–∞", "–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä", "–≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä", "—Ä–∞–¥–∏–∞—Ç–æ—Ä", "—Ç–µ—Ä–º–æ—Å—Ç–∞—Ç", "–∫–∏–ø–∏—Ç", "—Ö–æ–ª–æ–¥–Ω–æ"],
    "üõë –¢–æ—Ä–º–æ–∑–∞": ["—Ç–æ—Ä–º–æ–∑", "–∫–æ–ª–æ–¥–∫", "–¥–∏—Å–∫", "—Å—É–ø–ø–æ—Ä—Ç", "abs", "—Ä—É—á–Ω–∏–∫"],
}

PROJECT_ROOT = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
OUTPUT_FILE = os.path.join(PROJECT_ROOT, "news.json")
