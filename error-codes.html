<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–æ –æ—à–∏–±–∫–∞–º - –ú–∞—Å—Ç–µ—Ä—Å–∫–∞—è –ê–≤—Ç–æ—ç–ª–µ–∫—Ç—Ä–∏–∫–∞</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1 class="logo">‚ö° –ú–∞—Å—Ç–µ—Ä—Å–∫–∞—è –ê–≤—Ç–æ—ç–ª–µ–∫—Ç—Ä–∏–∫–∞</h1>
            <nav class="main-nav">
                <a href="/" class="nav-link">üè† –ì–ª–∞–≤–Ω–∞—è</a>
                <a href="/vehicles.html" class="nav-link">üöó –ü–æ –º–∞—Ä–∫–∞–º</a>
                <a href="/error-codes.html" class="nav-link active">üíª –ü–æ –æ—à–∏–±–∫–∞–º</a>
                <a href="/my-car.html" class="nav-link">üì± –ú–æ–µ –∞–≤—Ç–æ</a>
            </nav>
        </header>

        <section class="page-content">
            <h2>üíª –†–µ—à–µ–Ω–∏—è –ø–æ –∫–æ–¥–∞–º –æ—à–∏–±–æ–∫</h2>
            <div class="search-box">
                <input id="code-search" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –æ—à–∏–±–∫–∏ (P0300, C0040 –∏ —Ç.–¥.)">
                <button onclick="searchCodes()" class="btn btn-primary">–ù–∞–π—Ç–∏</button>
            </div>
            <div id="codes-list" class="codes-grid"></div>
        </section>
    </div>

    <script src="utils.js"></script>
    <script src="db-manager.js"></script>
    <script>
        let db;
        
        document.addEventListener('DOMContentLoaded', async () => {
            db = new DatabaseManager();
            await db.init();
            
            const codes = db._getUniqueErrorCodes();
            const codesList = document.getElementById('codes-list');
            
            codesList.innerHTML = codes.map(code => `
                <div class="code-card">
                    <h3>üíª ${code}</h3>
                    <p>${db.searchByErrorCode(code).length} —Ä–µ—à–µ–Ω–∏–π</p>
                    <button onclick="filterByCode('${code}')" class="btn btn-small">–ü–æ–∫–∞–∑–∞—Ç—å</button>
                </div>
            `).join('');
        });
        
        function searchCodes() {
            const code = document.getElementById('code-search').value.toUpperCase();
            const results = db.searchByErrorCode(code);
            const codesList = document.getElementById('codes-list');
            
            codesList.innerHTML = results.map(r => `
                <div class="result-card">
                    <h4>${r.title}</h4>
                    <p>${r.contentType} ‚Ä¢ ${r.source}</p>
                    <a href="${r.link}" target="_blank" class="btn btn-small">–ß–∏—Ç–∞—Ç—å</a>
                </div>
            `).join('') || '<p>–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>';
        }
    </script>
</body>
</html>
